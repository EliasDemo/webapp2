import{a as q}from"./chunk-SJXHNKEE.js";import{A as H,b as V,d as O,i as D,r as j,s as L,t as G}from"./chunk-J2XPQYKK.js";import"./chunk-LWNR2F3M.js";import{d as A,f as N}from"./chunk-5VQTM22E.js";import{j as B,k as F,u as T}from"./chunk-FE5WSVYG.js";import{$ as p,$a as e,Ka as M,Pa as v,T as S,Tb as P,Y as E,Z as y,_ as c,_a as s,ab as t,bb as d,fa as u,gb as C,kb as g,mb as h,n as _,tb as k,vb as r,wb as w,xb as b,ya as o,yb as I}from"./chunk-63T4HJ2B.js";import"./chunk-IMPBB4AK.js";function Y(l,a){if(l&1&&(e(0,"div",51)(1,"div",46),c(),e(2,"svg",52),d(3,"path",53),t(),p(),e(4,"div")(5,"h3",54),r(6,"Error en la asignaci\xF3n"),t(),e(7,"p",55),r(8),t()()()()),l&2){let n=h();o(8),w(n.error())}}function $(l,a){l&1&&(c(),e(0,"svg",56),d(1,"path",57),t())}function R(l,a){l&1&&(c(),e(0,"svg",42),d(1,"path",23),t())}function U(l,a){if(l&1&&(e(0,"option",30),r(1),t()),l&2){let n=a.$implicit;s("ngValue",n.id),o(),I(" ",n.nombre," (",n.codigo,") ")}}function J(l,a){if(l&1){let n=C();e(0,"div",60),g("click",function(){let m=E(n).$implicit,f=h(2);return y(f.seleccionar(m))}),e(1,"div",61)(2,"div",62)(3,"div",63)(4,"div",64),c(),e(5,"svg",65),d(6,"path",66),t()(),p(),e(7,"div")(8,"div",67),r(9),t(),e(10,"div",68)(11,"span",69),r(12),t(),e(13,"span"),r(14),t()()()()(),e(15,"div",70)(16,"span",71),r(17),t(),d(18,"div",72),t()()()}if(l&2){let n=a.$implicit,i=h(2);k("bg-blue-50",i.selectedId()===n.id)("border-l-4",i.selectedId()===n.id)("border-l-[#003B5C]",i.selectedId()===n.id),o(9),b(" ",n.nombre," "),o(3),b(" ",n.codigo," "),o(2),b("Facultad ID: ",n.facultad_id),o(3),b(" ID ",n.id," "),o(),k("bg-blue-500",i.selectedId()===n.id)}}function K(l,a){if(l&1&&(e(0,"div",58),v(1,J,19,12,"div",59),t()),l&2){let n=h();o(),s("ngForOf",n.resultadosFiltrados())("ngForTrackBy",n.trackByEp)}}function Q(l,a){l&1&&(e(0,"div",73),c(),e(1,"svg",74),d(2,"path",75),t(),p(),e(3,"p",76),r(4,"No se encontraron escuelas profesionales"),t(),e(5,"p",77),r(6,"Intente con otros t\xE9rminos de b\xFAsqueda"),t()())}function W(l,a){if(l&1&&(e(0,"div",78)(1,"div",61)(2,"div",70)(3,"div",79),c(),e(4,"svg",80),d(5,"path",81),t()(),p(),e(6,"div")(7,"div",82),r(8,"Escuela Profesional seleccionada:"),t(),e(9,"div",83),r(10),t(),e(11,"div",84),r(12),t()()()()()),l&2){let n=h();o(10),w(n.selectedName()),o(2),b("ID ",n.selectedId())}}function X(l,a){l&1&&(c(),e(0,"svg",56),d(1,"path",57),t())}function Z(l,a){l&1&&(c(),e(0,"svg",42),d(1,"path",81),t())}var x=class x{constructor(){this.api=S(q);this.route=S(A);this.router=S(N);this.sedeId=Number(this.route.snapshot.paramMap.get("id"));this.loading=u(!1);this.error=u(null);this.sede=u(null);this.facs=u([]);this.q=u("");this.resultados=u([]);this.facFilterId=u(null);this.selectedId=u(null);this.selectedName=u(null);this.desde=u(null);this.hasta=u(null);this.resultadosFiltrados=P(()=>{let a=this.facFilterId(),n=this.resultados();return a?n.filter(i=>i.facultad_id===a):n});this.trackByFac=(a,n)=>n.id;this.trackByEp=(a,n)=>n.id;this.bootstrap()}async bootstrap(){if(!this.sedeId||Number.isNaN(this.sedeId)){this.router.navigate(["/ad/sedes"]);return}try{let[a,n]=await Promise.all([_(this.api.obtenerSede(this.sedeId)),_(this.api.listarFacultades(void 0,1,500))]);this.sede.set(a.data),this.facs.set(n.data?.items??[])}catch{}}onFacFilterChange(a){this.facFilterId.set(a===null?null:Number(a))}async buscar(){this.loading.set(!0),this.error.set(null);try{let a=await _(this.api.listarEscuelas(this.q().trim()||void 0,1,50));this.resultados.set(a.data?.items??[])}catch(a){this.error.set(a?.error?.message??"No se pudo buscar")}finally{this.loading.set(!1)}}seleccionar(a){this.selectedId.set(a.id),this.selectedName.set(a.nombre)}async guardar(){let a=this.selectedId();if(a){this.loading.set(!0),this.error.set(null);try{await _(this.api.attachSedeToEscuela(a,{sede_id:this.sedeId,vigente_desde:this.desde()??null,vigente_hasta:this.hasta()??null})),this.router.navigate(["/ad/sedes",this.sedeId])}catch(n){this.error.set(n?.error?.message??"No se pudo asignar la escuela a la sede")}finally{this.loading.set(!1)}}}volver(){this.router.navigate(["/ad/sedes",this.sedeId])}};x.\u0275fac=function(n){return new(n||x)},x.\u0275cmp=M({type:x,selectors:[["app-assign-ep-sede-page"]],decls:87,vars:20,consts:[[1,"min-h-screen","bg-gradient-to-br","from-slate-50","via-blue-50/20","to-indigo-50/10","py-8"],[1,"mx-auto","max-w-4xl","px-4","sm:px-6","lg:px-8"],[1,"mb-8","flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","gap-6"],[1,"flex","items-center","gap-4"],[1,"p-3","bg-white","rounded-2xl","shadow-lg","border","border-slate-200/60","backdrop-blur-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-[#003B5C]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"text-2xl","font-bold","bg-gradient-to-r","from-[#003B5C]","to-[#4A7729]","bg-clip-text","text-transparent"],[1,"text-slate-600","mt-2"],[1,"font-semibold","text-[#003B5C]"],[1,"group","inline-flex","items-center","justify-center","px-6","py-3","rounded-xl","border","border-slate-300","bg-white","text-slate-700","font-semibold","shadow","transition-all","duration-300","hover:bg-slate-50","hover:shadow-md","hover:scale-105","active:scale-95",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2","group-hover:-translate-x-1","transition-transform","duration-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],["class","mb-6 rounded-2xl border border-red-200 bg-red-50/90 backdrop-blur-sm p-6 shadow-lg transform transition-all duration-300 animate-in slide-in-from-top",4,"ngIf"],[1,"bg-white/90","backdrop-blur-sm","rounded-2xl","border","border-slate-200/60","shadow-xl","p-6","space-y-6","transform","transition-all","duration-300"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","space-y-2"],[1,"block","text-sm","font-semibold","text-slate-700"],[1,"flex","gap-3"],[1,"flex-1","relative"],["placeholder","Buscar por nombre o c\xF3digo...",1,"w-full","border","border-slate-300","rounded-xl","px-4","py-3.5","text-slate-700","bg-white","placeholder-slate-400","focus:outline-none","focus:ring-2","focus:ring-[#003B5C]","focus:border-transparent","transition-all","duration-200","shadow-sm",3,"ngModelChange","ngModel"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-slate-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],[1,"group","inline-flex","items-center","justify-center","px-6","py-3.5","rounded-xl","bg-gradient-to-r","from-[#003B5C]","to-[#4A7729]","hover:from-[#003B5C]","hover:to-[#5a8a35]","text-white","font-semibold","shadow-lg","transition-all","duration-300","hover:shadow-xl","hover:scale-105","active:scale-95","disabled:opacity-50","disabled:cursor-not-allowed","disabled:transform-none",3,"click","disabled"],["class","w-4 h-4 mr-2 animate-spin","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],["class","w-4 h-4 mr-2 group-hover:scale-110 transition-transform duration-200","fill","none","stroke","currentColor","viewBox","0 0 24 24",4,"ngIf"],[1,"space-y-2"],[1,"relative"],[1,"w-full","border","border-slate-300","rounded-xl","px-4","py-3.5","text-slate-700","bg-white","focus:outline-none","focus:ring-2","focus:ring-[#003B5C]","focus:border-transparent","transition-all","duration-200","shadow-sm","appearance-none",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf","ngForTrackBy"],[1,"absolute","inset-y-0","right-0","flex","items-center","pr-3","pointer-events-none"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],["class","max-h-80 overflow-auto border border-slate-200 rounded-xl shadow-inner bg-slate-50/50 scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-slate-100",4,"ngIf"],["class","text-center py-12 bg-slate-50/80 rounded-xl border border-slate-200",4,"ngIf"],["class","p-4 bg-gradient-to-r from-[#003B5C]/5 to-[#4A7729]/5 rounded-xl border border-[#003B5C]/20 transform transition-all duration-300 animate-in slide-in-from-bottom",4,"ngIf"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","p-4","bg-slate-50/80","rounded-xl","border","border-slate-200/60"],["type","date",1,"w-full","border","border-slate-300","rounded-xl","px-4","py-3.5","text-slate-700","bg-white","focus:outline-none","focus:ring-2","focus:ring-[#003B5C]","focus:border-transparent","transition-all","duration-200","shadow-sm",3,"ngModelChange","ngModel"],[1,"text-xs","text-slate-500"],[1,"flex","items-center","justify-end","gap-3","pt-4","border-t","border-slate-200/60"],[1,"group","inline-flex","items-center","justify-center","px-6","py-3.5","rounded-xl","border","border-slate-300","bg-white","text-slate-700","font-semibold","shadow","transition-all","duration-300","hover:bg-slate-50","hover:shadow-md","hover:scale-105","active:scale-95",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2","group-hover:scale-110","transition-transform","duration-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"group","inline-flex","items-center","justify-center","px-8","py-3.5","rounded-xl","bg-gradient-to-r","from-[#003B5C]","to-[#4A7729]","hover:from-[#003B5C]","hover:to-[#5a8a35]","text-white","font-semibold","shadow-lg","transition-all","duration-300","hover:shadow-xl","hover:scale-105","active:scale-95","disabled:opacity-50","disabled:cursor-not-allowed","disabled:transform-none",3,"click","disabled"],[1,"mt-8","bg-white/80","backdrop-blur-sm","rounded-2xl","border","border-slate-200/60","p-6","shadow-lg"],[1,"flex","items-start","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-[#003B5C]","mt-0.5","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-[#003B5C]","font-semibold","mb-2"],[1,"text-sm","text-slate-600","space-y-1"],[1,"mb-6","rounded-2xl","border","border-red-200","bg-red-50/90","backdrop-blur-sm","p-6","shadow-lg","transform","transition-all","duration-300","animate-in","slide-in-from-top"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-red-500","mt-0.5","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-red-800","font-semibold","mb-1"],[1,"text-red-700"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","mr-2","animate-spin"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 2v4m0 12v4m8-10h-4M6 12H2m15.364-7.364l-2.828 2.828M7.464 17.536l-2.828 2.828m12.728 0l-2.828-2.828M7.464 6.464L4.636 3.636"],[1,"max-h-80","overflow-auto","border","border-slate-200","rounded-xl","shadow-inner","bg-slate-50/50","scrollbar-thin","scrollbar-thumb-slate-300","scrollbar-track-slate-100"],["class","px-4 py-4 cursor-pointer transition-all duration-200 border-b last:border-b-0 border-slate-100 hover:bg-white hover:shadow-sm group",3,"bg-blue-50","border-l-4","border-l-[#003B5C]","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"px-4","py-4","cursor-pointer","transition-all","duration-200","border-b","last:border-b-0","border-slate-100","hover:bg-white","hover:shadow-sm","group",3,"click"],[1,"flex","items-center","justify-between"],[1,"flex-1","min-w-0"],[1,"flex","items-center","gap-3","mb-2"],[1,"p-2","bg-white","rounded-lg","border","border-slate-200","shadow-sm","group-hover:scale-110","transition-transform","duration-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-[#003B5C]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 14l9-5-9-5-9 5 9 5z"],[1,"font-semibold","text-slate-900","group-hover:text-[#003B5C]","transition-colors","duration-200","truncate"],[1,"text-xs","text-slate-500","flex","items-center","gap-3","mt-1"],[1,"bg-slate-100","text-slate-700","px-2","py-1","rounded-full","font-medium"],[1,"flex","items-center","gap-3"],[1,"text-xs","font-medium","text-slate-600","bg-white","px-2.5","py-1","rounded-full","border","border-slate-200","shadow-sm"],[1,"w-2","h-2","rounded-full","bg-green-400","animate-pulse"],[1,"text-center","py-12","bg-slate-50/80","rounded-xl","border","border-slate-200"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","mx-auto","text-slate-300","mb-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-slate-600","font-medium","mb-1"],[1,"text-slate-500","text-sm"],[1,"p-4","bg-gradient-to-r","from-[#003B5C]/5","to-[#4A7729]/5","rounded-xl","border","border-[#003B5C]/20","transform","transition-all","duration-300","animate-in","slide-in-from-bottom"],[1,"p-2","bg-white","rounded-lg","border","border-[#003B5C]/20","shadow-sm"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-[#003B5C]"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"text-sm","font-semibold","text-[#003B5C]"],[1,"text-lg","font-bold","text-slate-900"],[1,"text-xs","text-slate-600","mt-1"]],template:function(n,i){if(n&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),c(),e(5,"svg",5),d(6,"path",6),t()(),p(),e(7,"div")(8,"h1",7),r(9," Asignar Escuela Profesional "),t(),e(10,"p",8)(11,"span",9),r(12),t()()()(),e(13,"button",10),g("click",function(){return i.volver()}),c(),e(14,"svg",11),d(15,"path",12),t(),r(16," Volver "),t()(),v(17,Y,9,1,"div",13),p(),e(18,"div",14)(19,"div",15)(20,"div",16)(21,"label",17),r(22,"Buscar Escuela Profesional"),t(),e(23,"div",18)(24,"div",19)(25,"input",20),g("ngModelChange",function(f){return i.q.set(f)}),t(),e(26,"div",21),c(),e(27,"svg",22),d(28,"path",23),t()()(),p(),e(29,"button",24),g("click",function(){return i.buscar()}),v(30,$,2,0,"svg",25)(31,R,2,0,"svg",26),r(32),t()()(),e(33,"div",27)(34,"label",17),r(35,"Filtrar por Facultad"),t(),e(36,"div",28)(37,"select",29),g("ngModelChange",function(f){return i.onFacFilterChange(f)}),e(38,"option",30),r(39,"\u2014 Todas las facultades \u2014"),t(),v(40,U,2,3,"option",31),t(),e(41,"div",32),c(),e(42,"svg",22),d(43,"path",33),t()()()()(),v(44,K,2,2,"div",34)(45,Q,7,0,"div",35)(46,W,13,2,"div",36),p(),e(47,"div",37)(48,"div",27)(49,"label",17),r(50,"Vigente desde"),t(),e(51,"input",38),g("ngModelChange",function(f){return i.desde.set(f)}),t(),e(52,"p",39),r(53,"Fecha de inicio de vigencia (opcional)"),t()(),e(54,"div",27)(55,"label",17),r(56,"Vigente hasta"),t(),e(57,"input",38),g("ngModelChange",function(f){return i.hasta.set(f)}),t(),e(58,"p",39),r(59,"Fecha de fin de vigencia (opcional)"),t()()(),e(60,"div",40)(61,"button",41),g("click",function(){return i.volver()}),c(),e(62,"svg",42),d(63,"path",43),t(),r(64," Cancelar "),t(),p(),e(65,"button",44),g("click",function(){return i.guardar()}),v(66,X,2,0,"svg",25)(67,Z,2,0,"svg",26),r(68),t()()(),e(69,"div",45)(70,"div",46),c(),e(71,"svg",47),d(72,"path",48),t(),p(),e(73,"div")(74,"h3",49),r(75,"Informaci\xF3n sobre asignaciones"),t(),e(76,"ul",50)(77,"li"),r(78,"\u2022 Busque y seleccione una escuela profesional para asignarla a esta sede"),t(),e(79,"li"),r(80,"\u2022 Puede filtrar los resultados por facultad espec\xEDfica"),t(),e(81,"li"),r(82,"\u2022 Las fechas de vigencia son opcionales para definir periodos espec\xEDficos"),t(),e(83,"li"),r(84,"\u2022 Una escuela profesional puede estar asignada a m\xFAltiples sedes"),t(),e(85,"li"),r(86,"\u2022 Las asignaciones pueden ser modificadas posteriormente"),t()()()()()()()),n&2){let m;o(12),w(((m=i.sede())==null?null:m.nombre)||"Sede "+i.sedeId),o(5),s("ngIf",i.error()),o(8),s("ngModel",i.q()),o(4),s("disabled",i.loading()),o(),s("ngIf",i.loading()),o(),s("ngIf",!i.loading()),o(),b(" ",i.loading()?"Buscando...":"Buscar"," "),o(5),s("ngModel",i.facFilterId()),o(),s("ngValue",null),o(2),s("ngForOf",i.facs())("ngForTrackBy",i.trackByFac),o(4),s("ngIf",i.resultadosFiltrados().length),o(),s("ngIf",i.resultados().length===0&&i.q()),o(),s("ngIf",i.selectedId()),o(5),s("ngModel",i.desde()),o(6),s("ngModel",i.hasta()),o(8),s("disabled",i.loading()||!i.selectedId()),o(),s("ngIf",i.loading()),o(),s("ngIf",!i.loading()),o(),b(" ",i.loading()?"Asignando...":"Asignar Escuela Profesional"," ")}},dependencies:[T,B,F,H,L,G,V,j,O,D],styles:["[_nghost-%COMP%]{display:block}@keyframes _ngcontent-%COMP%_fade-in{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fade-in-up{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_pulse-slow{0%,to{opacity:.6}50%{opacity:1}}.animate-fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in .6s ease-out}.animate-fade-in-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fade-in-up .8s ease-out}.animate-pulse-slow[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse-slow 2s ease-in-out infinite}button[_ngcontent-%COMP%]:focus-visible, select[_ngcontent-%COMP%]:focus-visible, input[_ngcontent-%COMP%]:focus-visible{outline:2px solid #3b82f6;outline-offset:2px;border-radius:.5rem}*[_ngcontent-%COMP%]{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.3s}.loading-state[_ngcontent-%COMP%]{background:linear-gradient(90deg,#f1f5f9 25%,#e2e8f0,#f1f5f9 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_loading 1.5s infinite}@keyframes _ngcontent-%COMP%_loading{0%{background-position:200% 0}to{background-position:-200% 0}}"]});var z=x;export{z as AssignEpSedePage};
