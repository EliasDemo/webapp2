import{a as G}from"./chunk-ZHWJTMU2.js";import{a as Z}from"./chunk-IZ77CWTJ.js";import{A as q,d as V,i as H,r as $,s as z,t as U}from"./chunk-J2XPQYKK.js";import"./chunk-LWNR2F3M.js";import{g as L,h as j,j as B}from"./chunk-5VQTM22E.js";import{j as C,k as N,s as O,u as F}from"./chunk-FE5WSVYG.js";import{$a as e,Fb as T,Ka as w,Kb as h,Mb as _,Pa as p,T as E,Tb as y,Y as A,Z as P,_a as d,ab as t,bb as s,eb as I,fa as x,fb as k,gb as R,kb as g,mb as c,sb as D,tb as S,vb as i,wb as b,xb as m,ya as o,yb as M}from"./chunk-63T4HJ2B.js";import"./chunk-IMPBB4AK.js";var K=()=>({exact:!0});function Q(a,l){if(a&1){let n=R();e(0,"div",52)(1,"div",53)(2,"div",54),s(3,"i",55),t(),e(4,"div",56)(5,"div",57),i(6,"No se pudo obtener el avance"),t(),e(7,"div",58),i(8),t()(),e(9,"button",59),g("click",function(){A(n);let u=c();return P(u.error.set(null))}),s(10,"i",60),t()()()}if(a&2){let n=c();o(8),b(n.error())}}function W(a,l){if(a&1&&(e(0,"span"),i(1),t()),a&2){let n=c().$implicit;o(),m(" \u2022 ",n.estado)}}function X(a,l){if(a&1&&(e(0,"option",40),i(1),p(2,W,2,1,"span",61),t()),a&2){let n=l.$implicit;d("ngValue",n.id),o(),M(" ",n.anio,"-",n.ciclo," "),o(),d("ngIf",n.estado)}}function Y(a,l){a&1&&s(0,"i",62)}function ee(a,l){a&1&&(e(0,"section",63)(1,"div",64)(2,"div",65),s(3,"i",66),t(),e(4,"h2",67),i(5,"Todav\xEDa no hay horas registradas para el filtro"),t(),e(6,"p",28),i(7," Ajusta el estado o el per\xEDodo, o registra horas en alguno de tus proyectos/procesos. "),t()()())}function te(a,l){if(a&1&&(e(0,"section",23)(1,"div",68)(2,"div",69)(3,"div",70),i(4),t(),e(5,"div",71),i(6,"Proyectos"),t()(),e(7,"div",72)(8,"div",73),i(9),h(10,"number"),t(),e(11,"div",74),i(12,"Total horas"),t()(),e(13,"div",75)(14,"div",76),i(15),t(),e(16,"div",77),i(17,"Total minutos"),t()()()()),a&2){let n=c();o(4),b(n.proyectos().length),o(5),m(" ",_(10,3,n.totalHoras(),"1.0-2")," "),o(6),m(" ",n.totalMinutos()," ")}}function ie(a,l){if(a&1&&(I(0),i(1),h(2,"number"),k()),a&2){let n=c().$implicit;o(),m(" de ",_(2,1,n.horas_planificadas,"1.0-2")," h planificadas ")}}function ne(a,l){if(a&1&&(e(0,"div",99),i(1),t()),a&2){let n=c().$implicit;o(),m(" Faltan ",n.minutos_faltantes," min ")}}function oe(a,l){if(a&1&&(e(0,"span"),i(1),t()),a&2){let n=c().$implicit;o(),m(" de ",n.minutos_requeridos," min requeridos ")}}function ae(a,l){if(a&1&&(e(0,"div",84)(1,"div",85)(2,"div",86)(3,"div",87),s(4,"i",88),t()(),e(5,"div",56)(6,"div",89)(7,"div")(8,"h3",90),i(9),t(),e(10,"p",91),i(11),h(12,"number"),p(13,ie,3,4,"ng-container",61),t()(),e(14,"div",92)(15,"div",93),i(16),t(),p(17,ne,2,1,"div",94),t()(),e(18,"div",95)(19,"div",96),s(20,"div",97),t(),e(21,"div",98)(22,"span"),i(23),t(),p(24,oe,2,1,"span",61),t()()()()()),a&2){let n=l.$implicit,r=c(2);o(9),m(" ",n.titulo||"Proyecto #"+n.id," "),o(2),m(" ",_(12,9,n.horas,"1.0-2")," h registradas "),o(2),d("ngIf",n.horas_planificadas!=null),o(3),m(" ",r.porcentajeLabel(n)," "),o(),d("ngIf",n.minutos_faltantes!=null),o(3),D("width",n.porcentaje??0,"%"),o(3),m("",n.minutos," min"),o(),d("ngIf",n.minutos_requeridos!=null)}}function re(a,l){if(a&1&&(e(0,"section",78)(1,"div",79)(2,"div",4)(3,"div",80),s(4,"i",81),t(),e(5,"div")(6,"h2",27),i(7,"Detalle por proyecto"),t(),e(8,"p",28),i(9," Incluye tus horas sumadas desde proyectos y procesos asociados. "),t()()()(),e(10,"div",82),p(11,ae,25,12,"div",83),t()()),a&2){let n=c();o(11),d("ngForOf",n.proyectos())("ngForTrackBy",n.trackProyecto)}}function le(a,l){a&1&&(e(0,"div",100)(1,"div",101)(2,"div",102),s(3,"div",103)(4,"div",104),t(),e(5,"div",105),i(6,"Consultando"),t(),e(7,"div",106),i(8,"Un momento por favor\u2026"),t()()())}var v=class v{constructor(){this.rpApi=E(G);this.lookups=E(Z);this.loading=x(!1);this.error=x(null);this.estado=x("APROBADO");this.periodoId=x(null);this.periodos=x([]);this.data=x(null);this.proyectos=y(()=>this.data()?.por_proyecto??[]);this.totalHoras=y(()=>this.data()?.total_horas??0);this.totalMinutos=y(()=>this.data()?.total_minutos??0);this.trackPeriodo=(l,n)=>n.id;this.trackProyecto=(l,n)=>n.id;this.loadPeriodos(),this.consultar()}loadPeriodos(){this.lookups.fetchPeriodos("",!1,100).subscribe({next:l=>this.periodos.set(l),error:()=>this.periodos.set([])})}consultar(){this.error.set(null),this.loading.set(!0);let l={estado:this.estado(),periodo_id:this.periodoId()??void 0};this.rpApi.obtenerMiAvancePorProyecto(l).subscribe({next:n=>{this.data.set(n.data)},error:n=>{let r=n?.error?.message||"No se pudo obtener el avance.";this.error.set(r)},complete:()=>this.loading.set(!1)})}limpiar(){this.estado.set("APROBADO"),this.periodoId.set(null),this.data.set(null),this.error.set(null),this.consultar()}porcentajeLabel(l){return l.porcentaje==null?"\u2014":`${l.porcentaje}%`}};v.\u0275fac=function(n){return new(n||v)},v.\u0275cmp=w({type:v,selectors:[["rp-avance-page"]],decls:86,vars:22,consts:[[1,"min-h-screen","bg-gradient-to-br","from-slate-50","to-blue-50/30","pb-16"],[1,"border-b","border-slate-200","bg-white/80","backdrop-blur-sm","sticky","top-0","z-10"],[1,"max-w-7xl","mx-auto","px-4","py-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","items-center","gap-3"],[1,"p-2","rounded-xl","bg-indigo-100","text-indigo-700"],[1,"fa-solid","fa-diagram-project","text-lg"],[1,"text-xs","text-slate-500","mb-1","flex","items-center","gap-1"],["routerLink","/",1,"hover:text-slate-700","font-medium","transition-colors"],[1,"fa-solid","fa-chevron-right","text-[10px]","text-slate-400"],["routerLink","/r",1,"hover:text-slate-700","font-medium","transition-colors"],[1,"text-indigo-700","font-semibold"],[1,"text-2xl","font-bold","text-slate-900"],[1,"text-sm","text-slate-600","mt-1"],[1,"inline-flex","items-center","gap-2","rounded-xl","border","border-indigo-200","bg-white","px-4","py-2.5","text-sm","font-semibold","text-indigo-700","hover:bg-indigo-50","hover:border-indigo-300","transition-all","duration-200","shadow-sm","hover:shadow-md","disabled:opacity-50",3,"click","disabled"],[1,"fa-solid","fa-rotate-right"],[1,"mt-4","flex","flex-wrap","gap-2"],["routerLink","/r/horas","routerLinkActive","bg-indigo-600 text-white",1,"inline-flex","items-center","gap-2","rounded-lg","px-3","py-1.5","text-xs","font-semibold","border","border-indigo-200","text-indigo-700","hover:bg-indigo-50","transition-colors",3,"routerLinkActiveOptions"],[1,"fa-solid","fa-table"],["routerLink","/r/avance","routerLinkActive","bg-indigo-600 text-white",1,"inline-flex","items-center","gap-2","rounded-lg","px-3","py-1.5","text-xs","font-semibold","border","border-indigo-200","text-indigo-700","hover:bg-indigo-50","transition-colors"],[1,"fa-solid","fa-diagram-project"],[1,"max-w-5xl","mx-auto","px-4","pt-8","space-y-8"],["class","rounded-2xl border border-rose-200 bg-white p-4 shadow-sm animate-fade-in",4,"ngIf"],[1,"rounded-2xl","border","border-slate-200","bg-white","p-6","shadow-sm"],[1,"flex","items-center","justify-between","mb-6"],[1,"p-2","rounded-xl","bg-indigo-100","text-indigo-600"],[1,"fa-solid","fa-filter","text-sm"],[1,"text-lg","font-bold","text-slate-900"],[1,"text-sm","text-slate-600"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"space-y-2"],[1,"block","text-sm","font-semibold","text-slate-700"],[1,"w-full","rounded-xl","border","border-slate-300","bg-white","px-4","py-3","text-sm",3,"ngModelChange","ngModel"],["value","APROBADO"],["value","PENDIENTE"],["value","RECHAZADO"],["value","ANULADO"],["value","*"],[1,"text-xs","text-slate-500"],[1,"space-y-2","md:col-span-2"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-wrap","gap-3","pt-6"],[1,"inline-flex","items-center","gap-3","rounded-xl","bg-indigo-600","px-6","py-3","text-sm","font-semibold","text-white","hover:bg-indigo-700","disabled:opacity-50","transition-all","shadow-md","hover:shadow-lg",3,"click","disabled"],[1,"fa-solid","fa-magnifying-glass"],["class","fa-solid fa-circle-notch animate-spin",4,"ngIf"],[1,"inline-flex","items-center","gap-2","rounded-xl","border","border-slate-300","bg-white","px-5","py-3","text-sm","font-semibold","text-slate-700","hover:bg-slate-50","disabled:opacity-50",3,"click","disabled"],[1,"fa-solid","fa-broom"],["class","rounded-2xl border border-slate-200 bg-white p-10 shadow-sm",4,"ngIf"],["class","rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",4,"ngIf"],["class","rounded-2xl border border-slate-200 bg-white p-6 shadow-sm space-y-4",4,"ngIf"],["class","fixed inset-0 bg-white/70 backdrop-blur-sm z-50 grid place-items-center",4,"ngIf"],[1,"rounded-2xl","border","border-rose-200","bg-white","p-4","shadow-sm","animate-fade-in"],[1,"flex","items-start","gap-4"],[1,"flex-shrink-0","p-2","rounded-lg","bg-rose-100","text-rose-600"],[1,"fa-solid","fa-circle-exclamation","text-sm"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-rose-900","mb-1"],[1,"text-sm","text-rose-700"],[1,"flex-shrink-0","text-slate-400","hover:text-slate-600","transition-colors",3,"click"],[1,"fa-solid","fa-xmark","text-sm"],[4,"ngIf"],[1,"fa-solid","fa-circle-notch","animate-spin"],[1,"rounded-2xl","border","border-slate-200","bg-white","p-10","shadow-sm"],[1,"max-w-2xl","mx-auto","text-center","space-y-4"],[1,"mx-auto","w-14","h-14","grid","place-items-center","rounded-2xl","bg-indigo-50","text-indigo-600"],[1,"fa-solid","fa-inbox","text-xl"],[1,"text-xl","font-bold","text-slate-900"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"text-center","p-4","rounded-xl","bg-indigo-50","border","border-indigo-200"],[1,"text-2xl","font-black","text-indigo-700"],[1,"text-xs","font-medium","text-indigo-700","mt-1"],[1,"text-center","p-4","rounded-xl","bg-emerald-50","border","border-emerald-200"],[1,"text-2xl","font-black","text-emerald-700"],[1,"text-xs","font-medium","text-emerald-700","mt-1"],[1,"text-center","p-4","rounded-xl","bg-slate-50","border","border-slate-200"],[1,"text-2xl","font-black","text-slate-800"],[1,"text-xs","font-medium","text-slate-600","mt-1"],[1,"rounded-2xl","border","border-slate-200","bg-white","p-6","shadow-sm","space-y-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"p-2","rounded-xl","bg-slate-100","text-slate-600"],[1,"fa-solid","fa-list-ul","text-sm"],[1,"space-y-4"],["class","rounded-xl border border-slate-200 bg-slate-50/60 p-4 hover:bg-slate-50 transition-colors",4,"ngFor","ngForOf","ngForTrackBy"],[1,"rounded-xl","border","border-slate-200","bg-slate-50/60","p-4","hover:bg-slate-50","transition-colors"],[1,"flex","items-start","gap-3"],[1,"mt-1"],[1,"w-9","h-9","rounded-xl","bg-indigo-100","text-indigo-600","grid","place-items-center"],[1,"fa-solid","fa-briefcase","text-sm"],[1,"flex","flex-wrap","items-start","justify-between","gap-2"],[1,"text-sm","font-semibold","text-slate-900"],[1,"text-xs","text-slate-600","mt-0.5"],[1,"text-right","text-xs"],[1,"font-mono","font-semibold","text-slate-900"],["class","text-slate-500 mt-0.5",4,"ngIf"],[1,"mt-3"],[1,"w-full","h-2.5","rounded-full","bg-slate-200","overflow-hidden"],[1,"h-full","rounded-full","bg-gradient-to-r","from-indigo-500","to-emerald-500","transition-all"],[1,"mt-1","flex","justify-between","text-[11px]","text-slate-500","font-mono"],[1,"text-slate-500","mt-0.5"],[1,"fixed","inset-0","bg-white/70","backdrop-blur-sm","z-50","grid","place-items-center"],[1,"text-center"],[1,"relative"],[1,"w-16","h-16","rounded-full","border-4","border-slate-200"],[1,"absolute","inset-0","w-16","h-16","animate-spin","rounded-full","border-4","border-indigo-600","border-t-transparent"],[1,"mt-4","text-lg","font-semibold","text-slate-900"],[1,"text-sm","text-slate-600","mt-2"]],template:function(n,r){n&1&&(e(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),s(6,"i",6),t(),e(7,"div")(8,"nav",7)(9,"a",8),i(10,"Inicio"),t(),s(11,"i",9),e(12,"a",10),i(13,"Reportes"),t(),s(14,"i",9),e(15,"span",11),i(16,"Mi avance por proyecto"),t()(),e(17,"h1",12),i(18,"Mi avance por proyecto"),t(),e(19,"p",13),i(20," Se muestran las horas aprobadas registradas en tus proyectos y procesos vinculados. "),t()()(),e(21,"div",4)(22,"button",14),g("click",function(){return r.consultar()}),s(23,"i",15),e(24,"span"),i(25),t()()()(),e(26,"div",16)(27,"a",17),s(28,"i",18),i(29," Horas por per\xEDodo "),t(),e(30,"a",19),s(31,"i",20),i(32," Mi avance por proyecto "),t()()()(),e(33,"main",21),p(34,Q,11,1,"div",22),e(35,"section",23)(36,"div",24)(37,"div",4)(38,"div",25),s(39,"i",26),t(),e(40,"div")(41,"h2",27),i(42,"Filtros"),t(),e(43,"p",28),i(44,"Acota el avance por estado y per\xEDodo acad\xE9mico"),t()()()(),e(45,"div",29)(46,"div",30)(47,"label",31),i(48,"Estado de registro"),t(),e(49,"select",32),g("ngModelChange",function(f){return r.estado.set(f)}),e(50,"option",33),i(51,"Solo APROBADO"),t(),e(52,"option",34),i(53,"Solo PENDIENTE"),t(),e(54,"option",35),i(55,"Solo RECHAZADO"),t(),e(56,"option",36),i(57,"Solo ANULADO"),t(),e(58,"option",37),i(59,"Todos (*)"),t()(),e(60,"p",38),i(61," Por defecto se consideran solo registros "),e(62,"b"),i(63,"APROBADO"),t(),i(64,". "),t()(),e(65,"div",39)(66,"label",31),i(67,"Per\xEDodo acad\xE9mico (opcional)"),t(),e(68,"select",32),g("ngModelChange",function(f){return r.periodoId.set(f?+f:null)}),e(69,"option",40),i(70,"Todos los per\xEDodos"),t(),p(71,X,3,4,"option",41),t(),e(72,"p",38),i(73," Si no eliges per\xEDodo, se suman las horas de todos tus per\xEDodos. "),t()()(),e(74,"div",42)(75,"button",43),g("click",function(){return r.consultar()}),s(76,"i",44),p(77,Y,1,0,"i",45),i(78),t(),e(79,"button",46),g("click",function(){return r.limpiar()}),s(80,"i",47),i(81," Limpiar "),t()()(),p(82,ee,8,0,"section",48)(83,te,18,6,"section",49)(84,re,12,2,"section",50)(85,le,9,0,"div",51),t()()),n&2&&(o(22),d("disabled",r.loading()),o(),S("animate-spin",r.loading()),o(2),b(r.loading()?"Actualizando\u2026":"Refrescar"),o(2),d("routerLinkActiveOptions",T(21,K)),o(7),d("ngIf",r.error()),o(15),d("ngModel",r.estado()),o(19),d("ngModel",r.periodoId()),o(),d("ngValue",null),o(2),d("ngForOf",r.periodos())("ngForTrackBy",r.trackPeriodo),o(4),d("disabled",r.loading()),o(),S("hidden",r.loading()),o(),d("ngIf",r.loading()),o(),m(" ",r.loading()?"Consultando...":"Consultar"," "),o(),d("disabled",r.loading()),o(3),d("ngIf",!r.loading()&&!r.error()&&!r.proyectos().length),o(),d("ngIf",r.proyectos().length),o(),d("ngIf",r.proyectos().length),o(),d("ngIf",r.loading()))},dependencies:[F,C,N,q,z,U,$,V,H,B,L,j,O],encapsulation:2});var J=v;export{J as RpAvancePage};
