import{a as ne}from"./chunk-IZ77CWTJ.js";import{A as ae,d as Z,i as ee,r as te,s as ie,t as re}from"./chunk-J2XPQYKK.js";import{a as Y}from"./chunk-LWNR2F3M.js";import{g as Q,h as W,j as X}from"./chunk-5VQTM22E.js";import{C as J,i as z,j as H,k as K,s as q,u as G}from"./chunk-FE5WSVYG.js";import{$a as e,Fb as B,Ka as O,Kb as j,Mb as U,O as L,Ob as $,Pa as b,S as C,T as F,Tb as S,Y as w,Z as k,_a as c,ab as t,bb as l,fa as g,gb as M,kb as v,mb as f,rb as V,sb as A,tb as T,vb as r,wb as p,xb as x,ya as o,yb as R,zb as N}from"./chunk-63T4HJ2B.js";import"./chunk-IMPBB4AK.js";var _=class _{constructor(a,i){this.http=a;this.base=i}importarMatriculas(a){let i=new FormData;return i.append("file",a.file),i.append("periodo_id",String(a.periodo_id)),a.ep_sede_id!==void 0&&a.ep_sede_id!==null&&i.append("ep_sede_id",String(a.ep_sede_id)),this.http.post(`${this.base}/matriculas/import`,i)}descargarPlantilla(){return this.http.get(`${this.base}/matriculas/plantilla`,{responseType:"blob"})}};_.\u0275fac=function(i){return new(i||_)(C(J),C(Y))},_.\u0275prov=L({token:_,factory:_.\u0275fac,providedIn:"root"});var P=_;var de=()=>({exact:!0});function me(s,a){if(s&1){let i=M();e(0,"button",103),v("click",function(){let d=w(i).$implicit,m=f(3);return k(m.epSedeId.set(d))}),l(1,"i",104),r(2),t()}if(s&2){let i=a.$implicit;o(2),x(" ID ",i," ")}}function ce(s,a){if(s&1&&(e(0,"div",97)(1,"div",98),l(2,"i",99),r(3," EP-SEDE disponibles para tu usuario: "),t(),e(4,"div",100),b(5,me,3,1,"button",101),t(),e(6,"div",102),r(7,"Haz clic en un ID para seleccionarlo autom\xE1ticamente y vuelve a importar."),t()()),s&2){let i=f(2);o(5),c("ngForOf",i.choices())}}function ue(s,a){if(s&1){let i=M();e(0,"div",87)(1,"div",88)(2,"div",89),l(3,"i",90),t(),e(4,"div",91)(5,"div",92),r(6,"Error al procesar"),t(),e(7,"div",93),r(8),t(),b(9,ce,8,1,"div",94),t(),e(10,"button",95),v("click",function(){w(i);let d=f();return k(d.error.set(null))}),l(11,"i",96),t()()()}if(s&2){let i,n=f();o(8),p(n.error()),o(),c("ngIf",(i=n.choices())==null?null:i.length)}}function pe(s,a){if(s&1&&(e(0,"option",41),r(1),t()),s&2){let i=a.$implicit;c("ngValue",i.id),o(),N(" ",i.anio,"-",i.ciclo," ",(i.estado||"")==="EN_CURSO"?"\u2022 En curso":""," ")}}function xe(s,a){if(s&1){let i=M();e(0,"div",105)(1,"div",106)(2,"div",5),l(3,"i",107),e(4,"div")(5,"div",108),r(6),t(),e(7,"div",109),r(8),t()()(),e(9,"button",110),v("click",function(){w(i);let d=f();return k(d.archivo.set(null))}),l(10,"i",111),t()()()}if(s&2){let i=f();o(6),p(i.archivoNombre()),o(2),x("",i.archivoPesoKB()," KB \u2022 Listo para importar")}}function ge(s,a){s&1&&l(0,"i",112)}function be(s,a){if(s&1&&(e(0,"section",30)(1,"div",31)(2,"div",113),l(3,"i",114),t(),e(4,"h3",34),r(5,"Resumen del Proceso"),t()(),e(6,"div",115)(7,"div",116)(8,"div",117),r(9),t(),e(10,"div",118),r(11,"Total Procesadas"),t()(),e(12,"div",119)(13,"div",120),r(14),t(),e(15,"div",121),r(16,"\xC9xitos"),t()(),e(17,"div",122)(18,"div",123),r(19),t(),e(20,"div",124),r(21,"Errores"),t()(),e(22,"div",125)(23,"div",126),r(24),t(),e(25,"div",127),r(26,"Matr\xEDculas C/A"),t()()(),e(27,"div",128)(28,"div",129)(29,"div",130)(30,"div",82),r(31),t(),e(32,"div",131),r(33,"Usuarios nuevos"),t()(),e(34,"div",130)(35,"div",82),r(36),t(),e(37,"div",131),r(38,"Expedientes nuevos"),t()()()()()),s&2){let i=f();o(9),p(i.summary().processed),o(5),p(i.totalOk()),o(5),p(i.totalError()),o(5),R("",i.summary().created_matriculas,"/",i.summary().updated_matriculas),o(7),x("+",i.summary().created_users),o(5),x("+",i.summary().created_expedientes)}}function ve(s,a){if(s&1&&(e(0,"div",43),r(1),t()),s&2){let i=a.ngIf;o(),N(" U:",i.user_id??"\u2014"," \u2022 E:",i.expediente_id??"\u2014"," \u2022 M:",i.matricula_id??"\u2014"," ")}}function fe(s,a){s&1&&r(0,"\u2014")}function he(s,a){if(s&1&&(e(0,"tr",146)(1,"td",147),r(2),t(),e(3,"td",148)(4,"span",149),l(5,"i",150),r(6),t()(),e(7,"td",148)(8,"div",151),r(9),t(),e(10,"div",109),r(11),t()(),e(12,"td",148)(13,"div",152),r(14),t(),e(15,"div",109),r(16),t()(),e(17,"td",148)(18,"div",152),r(19),t(),e(20,"div",109),r(21),t()(),e(22,"td",148)(23,"div",153),r(24),t(),b(25,ve,2,3,"div",154)(26,fe,1,0,"ng-template",null,0,$),t()()),s&2){let i=a.$implicit,n=V(27),d=f(2);o(2),p(i.row),o(2),c("ngClass",d.chipStatusClass(i.status)),o(2),x(" ",i.status==="ok"?"Correcto":"Error"," "),o(3),p((i.data==null?null:i.data.estudiante)||"\u2014"),o(2),p((i.data==null?null:i.data.codigo_estudiante)||"\u2014"),o(3),p((i.data==null?null:i.data.documento)||"\u2014"),o(2),p((i.data==null?null:i.data.correo_institucional)||"\u2014"),o(3),R("",(i.data==null?null:i.data.ciclo)||"\u2014"," - ",(i.data==null?null:i.data.grupo)||"\u2014"),o(2),p((i.data==null?null:i.data.modalidad_estudio)||"\u2014"),o(3),p(i.message),o(),c("ngIf",i.ids)("ngIfElse",n)}}function _e(s,a){if(s&1&&(e(0,"section",132)(1,"div",133)(2,"div",106)(3,"div",5)(4,"div",134),l(5,"i",135),t(),e(6,"div")(7,"h2",34),r(8,"Detalle del Resultado"),t(),e(9,"p",35),r(10,"Revisa el estado de cada registro procesado"),t()()(),e(11,"div",136)(12,"span",137),r(13),t(),e(14,"span",138),r(15),t()()()(),e(16,"div",139)(17,"div",140)(18,"table",141)(19,"thead",142)(20,"tr")(21,"th",143),r(22,"Fila"),t(),e(23,"th",143),r(24,"Estado"),t(),e(25,"th",143),r(26,"Estudiante"),t(),e(27,"th",143),r(28,"Documento"),t(),e(29,"th",143),r(30,"Ciclo/Grupo"),t(),e(31,"th",143),r(32,"Mensaje"),t()()(),e(33,"tbody",144),b(34,he,28,13,"tr",145),t()()()()()),s&2){let i=f();o(13),x(" ",i.totalOk()," correctos "),o(2),x(" ",i.totalError()," con errores "),o(19),c("ngForOf",i.rows())("ngForTrackBy",i.trackRow)}}function Ee(s,a){if(s&1&&(e(0,"div",155)(1,"div",130)(2,"div",156),l(3,"div",157)(4,"div",158),t(),e(5,"div",159),r(6,"Procesando archivo"),t(),e(7,"div",160),r(8," Progreso: "),e(9,"span",161),r(10),j(11,"number"),t()(),e(12,"div",162),l(13,"div",163),t(),e(14,"div",164),r(15,"Esto puede tomar unos momentos..."),t(),e(16,"div",165),l(17,"i",166),r(18," No cierres esta ventana durante el proceso "),t()()()),s&2){let i=f();o(10),x(" ",U(11,3,i.progress(),"1.0-0"),"% "),o(3),A("width",i.progress(),"%")}}var I=class I{constructor(){this.api=F(P);this.lookups=F(ne);this.loading=g(!1);this.error=g(null);this.progress=g(0);this.progressTimer=null;this.periodos=g([]);this.selectedPeriodoId=g(null);this.epSedeId=g(null);this.archivo=g(null);this.over=g(!1);this.summary=g(null);this.rows=g([]);this.choices=g(null);this.selectedPeriodo=S(()=>{let a=this.selectedPeriodoId();return this.periodos().find(i=>i.id===a)??null});this.totalOk=S(()=>this.rows().filter(a=>a.status==="ok").length);this.totalError=S(()=>this.rows().filter(a=>a.status==="error").length);this.archivoNombre=S(()=>this.archivo()?.name??"\u2014");this.archivoPesoKB=S(()=>{let a=this.archivo();return a?Math.round(a.size/1024):0});this.trackRow=(a,i)=>i.row;this.loadPeriodos()}loadPeriodos(){this.lookups.fetchPeriodos("",!1,50).subscribe({next:a=>{let i=[...a].sort((d,m)=>{let y=`${String(d.anio).padStart(4,"0")}-${String(d.ciclo).padStart(2,"0")}`;return`${String(m.anio).padStart(4,"0")}-${String(m.ciclo).padStart(2,"0")}`.localeCompare(y)});this.periodos.set(i);let n=i.find(d=>(d.estado||"").toUpperCase()==="EN_CURSO");n&&this.selectedPeriodoId.set(n.id)},error:()=>this.periodos.set([])})}onFileChange(a){let n=a.target?.files?.[0]??null;this.setFile(n)}onDrop(a){if(a.preventDefault(),this.over.set(!1),!a.dataTransfer)return;let i=a.dataTransfer.files;i&&i.length>0&&this.setFile(i[0])}onDragOver(a){a.preventDefault(),this.over.set(!0)}onDragLeave(a){a.preventDefault(),this.over.set(!1)}setFile(a){if(!a){this.archivo.set(null);return}if(!/(\.xlsx|\.xls|\.csv)$/i.test(a.name)){this.error.set("El archivo debe ser .xlsx, .xls o .csv"),this.archivo.set(null);return}this.error.set(null),this.archivo.set(a)}descargarPlantilla(){this.api.descargarPlantilla().subscribe({next:a=>{let i=URL.createObjectURL(a),n=document.createElement("a");n.href=i,n.download="plantilla_matriculas.xlsx",document.body.appendChild(n),n.click(),n.remove(),URL.revokeObjectURL(i)},error:a=>{this.error.set(a?.error?.message||"No se pudo descargar la plantilla.")}})}limpiar(){this.archivo.set(null),this.summary.set(null),this.rows.set([]),this.error.set(null),this.choices.set(null),this.epSedeId.set(null),this.progress.set(0),this.clearFakeProgress()}importar(){this.error.set(null),this.summary.set(null),this.rows.set([]),this.choices.set(null);let a=this.selectedPeriodoId(),i=this.archivo(),n=this.epSedeId();if(!a){this.error.set("Selecciona un per\xEDodo acad\xE9mico.");return}if(!i){this.error.set("Selecciona o arrastra un archivo Excel.");return}this.loading.set(!0),this.progress.set(0),this.startFakeProgress(),this.api.importarMatriculas({periodo_id:a,ep_sede_id:n??void 0,file:i}).subscribe({next:d=>{if(d.ok===!0){let m=d;this.summary.set(m.summary),this.rows.set(m.rows??[])}else{this.error.set(d?.message||"No se pudo procesar el archivo.");let m=d?.choices;Array.isArray(m)&&m.length&&this.choices.set(m)}this.progress.set(100)},error:d=>{this.error.set(d?.error?.message||"Error de red al importar."),this.loading.set(!1),this.progress.set(0),this.clearFakeProgress()},complete:()=>{this.loading.set(!1),this.progress()<100&&!this.error()&&this.progress.set(100),this.clearFakeProgress()}})}startFakeProgress(){this.clearFakeProgress(),this.progress.set(5),this.progressTimer=setInterval(()=>{if(!this.loading()){this.clearFakeProgress();return}let a=this.progress();a<90&&this.progress.set(a+3)},400)}clearFakeProgress(){this.progressTimer&&(clearInterval(this.progressTimer),this.progressTimer=null)}chipStatusClass(a){return a==="ok"?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}headerEstadoBadge(){return"bg-slate-100 text-slate-700 border-slate-200"}exportarCSV(){let a=this.rows();if(!a.length)return;let i=["row","status","message","user_id","expediente_id","matricula_id","usuario","email","estudiante","documento","correo_institucional","codigo_estudiante","ciclo","grupo","modalidad_estudio","modo_contrato","fecha_matricula","fecha_matricula_raw","pais","pais_iso2"],n=h=>{if(h==null)return"";let u=String(h);return/[",\n;]/.test(u)?`"${u.replace(/"/g,'""')}"`:u},d=[];d.push(i.join(",")),a.forEach(h=>{let u=h.data||{},D=h.ids||{},le=[h.row,h.status,h.message,D.user_id??"",D.expediente_id??"",D.matricula_id??"",u.usuario??"",u.email??"",u.estudiante??"",u.documento??"",u.correo_institucional??"",u.codigo_estudiante??"",u.ciclo??"",u.grupo??"",u.modalidad_estudio??"",u.modo_contrato??"",u.fecha_matricula??"",u.fecha_matricula_raw??"",u.pais??"",u.pais_iso2??""].map(n);d.push(le.join(","))});let m=new Blob([d.join(`
`)],{type:"text/csv;charset=utf-8;"}),y=URL.createObjectURL(m),E=document.createElement("a");E.href=y,E.download="resultado_import_matriculas.csv",document.body.appendChild(E),E.click(),E.remove(),URL.revokeObjectURL(y)}};I.\u0275fac=function(i){return new(i||I)},I.\u0275cmp=O({type:I,selectors:[["matriculas-import-page"]],decls:132,vars:30,consts:[["noIds",""],[1,"min-h-screen","bg-gradient-to-br","from-slate-50","to-blue-50/30","pb-16"],[1,"border-b","border-slate-200","bg-white/80","backdrop-blur-sm","sticky","top-0","z-10"],[1,"max-w-7xl","mx-auto","px-4","py-4"],[1,"flex","items-center","justify-between","gap-4"],[1,"flex","items-center","gap-3"],[1,"p-2","rounded-xl","bg-blue-100","text-blue-700"],[1,"fa-solid","fa-file-excel","text-lg"],[1,"text-xs","text-slate-500","mb-1","flex","items-center","gap-1"],["routerLink","/",1,"hover:text-slate-700","font-medium","transition-colors"],[1,"fa-solid","fa-chevron-right","text-[10px]","text-slate-400"],["routerLink","/m",1,"hover:text-slate-700","font-medium","transition-colors"],[1,"text-blue-600","font-semibold"],[1,"text-2xl","font-bold","text-slate-900"],[1,"text-sm","text-slate-600","mt-1"],[1,"inline-flex","items-center","gap-2","rounded-xl","border","border-blue-200","bg-white","px-4","py-2.5","text-sm","font-semibold","text-blue-700","hover:bg-blue-50","hover:border-blue-300","transition-all","duration-200","shadow-sm","hover:shadow-md",3,"click"],[1,"fa-solid","fa-file-arrow-down","text-blue-600"],[1,"mt-4","flex","flex-wrap","gap-2"],["routerLink","/m/import","routerLinkActive","bg-blue-600 text-white",1,"inline-flex","items-center","gap-2","rounded-lg","px-3","py-1.5","text-xs","font-semibold","border","border-blue-200","text-blue-700","hover:bg-blue-50","transition-colors",3,"routerLinkActiveOptions"],[1,"fa-solid","fa-file-import"],["routerLink","/m/manual/buscar","routerLinkActive","bg-blue-600 text-white",1,"inline-flex","items-center","gap-2","rounded-lg","px-3","py-1.5","text-xs","font-semibold","border","border-blue-200","text-blue-700","hover:bg-blue-50","transition-colors"],[1,"fa-solid","fa-magnifying-glass"],["routerLink","/m/manual/registrar","routerLinkActive","bg-blue-600 text-white",1,"inline-flex","items-center","gap-2","rounded-lg","px-3","py-1.5","text-xs","font-semibold","border","border-blue-200","text-blue-700","hover:bg-blue-50","transition-colors"],[1,"fa-solid","fa-user-pen"],["routerLink","/m/manual/matricular","routerLinkActive","bg-blue-600 text-white",1,"inline-flex","items-center","gap-2","rounded-lg","px-3","py-1.5","text-xs","font-semibold","border","border-blue-200","text-blue-700","hover:bg-blue-50","transition-colors"],[1,"fa-solid","fa-graduation-cap"],[1,"max-w-7xl","mx-auto","px-4","pt-8","space-y-8"],["class","rounded-2xl border border-rose-200 bg-white p-4 shadow-sm animate-fade-in",4,"ngIf"],[1,"grid","grid-cols-1","xl:grid-cols-3","gap-8"],[1,"xl:col-span-2","space-y-6"],[1,"rounded-2xl","border","border-slate-200","bg-white","p-6","shadow-sm"],[1,"flex","items-center","gap-3","mb-6"],[1,"p-2","rounded-xl","bg-blue-100","text-blue-600"],[1,"fa-solid","fa-gear","text-sm"],[1,"text-lg","font-bold","text-slate-900"],[1,"text-sm","text-slate-600"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"space-y-2"],[1,"block","text-sm","font-semibold","text-slate-700"],[1,"text-rose-500","ml-1"],[1,"w-full","rounded-xl","border","border-slate-300","bg-white","px-4","py-3","text-sm","transition-colors","focus:border-blue-500","focus:ring-2","focus:ring-blue-200",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"text-xs","text-slate-500","mt-1"],[1,"fa-solid","fa-info-circle","text-blue-500","mr-1"],[1,"p-2","rounded-xl","bg-emerald-100","text-emerald-600"],[1,"fa-solid","fa-file-upload","text-sm"],[1,"relative","rounded-2xl","border-2","border-dashed","transition-all","duration-300","group","cursor-pointer",3,"dragover","dragleave","drop"],[1,"p-8","text-center"],[1,"mx-auto","w-16","h-16","mb-4","rounded-2xl","bg-emerald-100","text-emerald-600","grid","place-items-center","group-hover:scale-110","transition-transform","duration-300"],[1,"fa-solid","fa-file-excel","text-2xl"],[1,"space-y-2","mb-4"],[1,"text-lg","font-semibold","text-slate-700"],[1,"text-sm","text-slate-500"],[1,"inline-flex","items-center","gap-2","rounded-xl","bg-slate-900","px-6","py-3","text-sm","font-semibold","text-white","hover:bg-slate-800","transition-colors","cursor-pointer","shadow-md","hover:shadow-lg"],["type","file","accept",".xlsx,.xls,.csv",1,"hidden",3,"change"],["class","mt-6 p-4 rounded-xl bg-slate-50 border border-slate-200",4,"ngIf"],[1,"mt-4","text-xs","text-slate-500"],[1,"flex","flex-wrap","gap-4","pt-4"],[1,"inline-flex","items-center","gap-3","rounded-xl","bg-blue-600","px-6","py-3.5","text-sm","font-semibold","text-white","hover:bg-blue-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-all","duration-200","shadow-lg","hover:shadow-xl","disabled:shadow-md",3,"click","disabled"],[1,"fa-solid","fa-play"],["class","fa-solid fa-circle-notch animate-spin",4,"ngIf"],[1,"inline-flex","items-center","gap-2","rounded-xl","border","border-slate-300","bg-white","px-5","py-3.5","text-sm","font-semibold","text-slate-700","hover:bg-slate-50","disabled:opacity-50","transition-all","duration-200",3,"click","disabled"],[1,"fa-solid","fa-broom"],[1,"inline-flex","items-center","gap-2","rounded-xl","border","border-slate-300","bg-white","px-5","py-3.5","text-sm","font-semibold","text-slate-700","hover:bg-slate-50","disabled:opacity-50","transition-all","duration-200","ml-auto",3,"click","disabled"],[1,"fa-solid","fa-file-export"],[1,"space-y-6"],[1,"flex","items-center","gap-3","mb-4"],[1,"p-2","rounded-xl","bg-purple-100","text-purple-600"],[1,"fa-solid","fa-circle-info","text-sm"],[1,"space-y-4"],[1,"flex","items-start","gap-3","p-3","rounded-xl","bg-blue-50/50","border","border-blue-100"],[1,"fa-solid","fa-table-columns","text-blue-600","mt-0.5","text-sm"],[1,"text-sm"],[1,"font-semibold","text-blue-900"],[1,"text-blue-700","mt-1","text-xs"],[1,"flex","items-start","gap-3","p-3","rounded-xl","bg-emerald-50/50","border","border-emerald-100"],[1,"fa-solid","fa-calendar-check","text-emerald-600","mt-0.5","text-sm"],[1,"font-semibold","text-emerald-900"],[1,"text-emerald-700","mt-1","text-xs"],[1,"flex","items-start","gap-3","p-3","rounded-xl","bg-slate-50/50","border","border-slate-200"],[1,"fa-solid","fa-key","text-slate-600","mt-0.5","text-sm"],[1,"font-semibold","text-slate-900"],[1,"text-slate-700","mt-1","text-xs"],["class","rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",4,"ngIf"],["class","rounded-2xl border border-slate-200 bg-white shadow-lg",4,"ngIf"],["class","fixed inset-0 bg-white/80 backdrop-blur-sm z-50 grid place-items-center",4,"ngIf"],[1,"rounded-2xl","border","border-rose-200","bg-white","p-4","shadow-sm","animate-fade-in"],[1,"flex","items-start","gap-4"],[1,"flex-shrink-0","p-2","rounded-lg","bg-rose-100","text-rose-600"],[1,"fa-solid","fa-circle-exclamation","text-sm"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-rose-900","mb-1"],[1,"text-sm","text-rose-700"],["class","mt-3 rounded-xl border border-amber-200 bg-amber-50/50 p-3",4,"ngIf"],[1,"flex-shrink-0","text-slate-400","hover:text-slate-600","transition-colors",3,"click"],[1,"fa-solid","fa-xmark","text-sm"],[1,"mt-3","rounded-xl","border","border-amber-200","bg-amber-50/50","p-3"],[1,"text-sm","font-semibold","text-amber-800","mb-2","flex","items-center","gap-2"],[1,"fa-solid","fa-lightbulb","text-amber-600"],[1,"flex","flex-wrap","gap-2"],["type","button","class","inline-flex items-center gap-2 rounded-lg border border-amber-300 bg-white px-3 py-1.5 text-sm font-medium text-amber-800 shadow-sm hover:bg-amber-50 transition-colors",3,"click",4,"ngFor","ngForOf"],[1,"text-xs","text-amber-700","mt-2"],["type","button",1,"inline-flex","items-center","gap-2","rounded-lg","border","border-amber-300","bg-white","px-3","py-1.5","text-sm","font-medium","text-amber-800","shadow-sm","hover:bg-amber-50","transition-colors",3,"click"],[1,"fa-solid","fa-building","text-amber-600","text-xs"],[1,"mt-6","p-4","rounded-xl","bg-slate-50","border","border-slate-200"],[1,"flex","items-center","justify-between"],[1,"fa-solid","fa-file-excel","text-emerald-600","text-lg"],[1,"font-semibold","text-slate-900","text-sm"],[1,"text-xs","text-slate-500"],[1,"text-slate-400","hover:text-rose-500","transition-colors",3,"click"],[1,"fa-solid","fa-trash","text-sm"],[1,"fa-solid","fa-circle-notch","animate-spin"],[1,"p-2","rounded-xl","bg-green-100","text-green-600"],[1,"fa-solid","fa-chart-bar","text-sm"],[1,"grid","grid-cols-2","gap-4"],[1,"text-center","p-4","rounded-xl","bg-slate-50","border","border-slate-200"],[1,"text-2xl","font-black","text-slate-900"],[1,"text-xs","font-medium","text-slate-600","mt-1"],[1,"text-center","p-4","rounded-xl","bg-emerald-50","border","border-emerald-200"],[1,"text-2xl","font-black","text-emerald-700"],[1,"text-xs","font-medium","text-emerald-700","mt-1"],[1,"text-center","p-4","rounded-xl","bg-rose-50","border","border-rose-200"],[1,"text-2xl","font-black","text-rose-700"],[1,"text-xs","font-medium","text-rose-700","mt-1"],[1,"text-center","p-4","rounded-xl","bg-blue-50","border","border-blue-200"],[1,"text-sm","font-black","text-blue-700"],[1,"text-xs","font-medium","text-blue-700","mt-1"],[1,"mt-4","p-3","rounded-xl","bg-slate-50","border","border-slate-200"],[1,"grid","grid-cols-2","gap-3","text-xs"],[1,"text-center"],[1,"text-slate-600"],[1,"rounded-2xl","border","border-slate-200","bg-white","shadow-lg"],[1,"p-6","border-b","border-slate-200"],[1,"p-2","rounded-xl","bg-slate-100","text-slate-600"],[1,"fa-solid","fa-table-list","text-sm"],[1,"flex","items-center","gap-2","text-sm"],[1,"px-3","py-1","rounded-full","bg-emerald-100","text-emerald-700","font-medium"],[1,"px-3","py-1","rounded-full","bg-rose-100","text-rose-700","font-medium"],[1,"overflow-hidden"],[1,"overflow-x-auto"],[1,"min-w-full","text-sm"],[1,"bg-slate-50","border-b","border-slate-200"],[1,"px-4","py-3","text-left","font-semibold","text-slate-700","text-xs","uppercase","tracking-wider"],[1,"divide-y","divide-slate-200"],["class","hover:bg-slate-50/50 transition-colors",4,"ngFor","ngForOf","ngForTrackBy"],[1,"hover:bg-slate-50/50","transition-colors"],[1,"px-4","py-3","font-mono","text-slate-600","text-xs"],[1,"px-4","py-3"],[1,"inline-flex","items-center","gap-1.5","rounded-full","px-2.5","py-1","text-xs","font-semibold",3,"ngClass"],[1,"fa-solid","fa-circle","text-[6px]"],[1,"font-medium","text-slate-900"],[1,"text-slate-900"],[1,"text-slate-900","text-xs","leading-relaxed"],["class","text-xs text-slate-500 mt-1",4,"ngIf","ngIfElse"],[1,"fixed","inset-0","bg-white/80","backdrop-blur-sm","z-50","grid","place-items-center"],[1,"relative"],[1,"w-16","h-16","rounded-full","border-4","border-slate-200"],[1,"absolute","inset-0","w-16","h-16","animate-spin","rounded-full","border-4","border-blue-600","border-t-transparent"],[1,"mt-4","text-lg","font-semibold","text-slate-900"],[1,"mt-1","text-sm","text-slate-700"],[1,"font-semibold"],[1,"mt-3","w-64","max-w-full","mx-auto","h-2","rounded-full","bg-slate-200","overflow-hidden"],[1,"h-2","bg-blue-600","transition-all","duration-300"],[1,"text-sm","text-slate-600","mt-3"],[1,"text-xs","text-slate-500","mt-4","animate-pulse"],[1,"fa-solid","fa-circle-info","mr-1"]],template:function(i,n){i&1&&(e(0,"div",1)(1,"header",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6),l(6,"i",7),t(),e(7,"div")(8,"nav",8)(9,"a",9),r(10,"Inicio"),t(),l(11,"i",10),e(12,"a",11),r(13,"Matr\xEDculas"),t(),l(14,"i",10),e(15,"span",12),r(16,"Importaci\xF3n"),t()(),e(17,"h1",13),r(18,"Importar Matr\xEDculas"),t(),e(19,"p",14),r(20,"Sube tu archivo Excel/CSV para procesar matr\xEDculas masivamente"),t()()(),e(21,"div",5)(22,"button",15),v("click",function(){return n.descargarPlantilla()}),l(23,"i",16),r(24," Descargar Plantilla "),t()()(),e(25,"div",17)(26,"a",18),l(27,"i",19),r(28," Importaci\xF3n "),t(),e(29,"a",20),l(30,"i",21),r(31," Manual \xB7 Buscar "),t(),e(32,"a",22),l(33,"i",23),r(34," Manual \xB7 Registrar/Editar "),t(),e(35,"a",24),l(36,"i",25),r(37," Manual \xB7 Matricular "),t()()()(),e(38,"main",26),b(39,ue,12,2,"div",27),e(40,"div",28)(41,"div",29)(42,"section",30)(43,"div",31)(44,"div",32),l(45,"i",33),t(),e(46,"div")(47,"h2",34),r(48,"Configuraci\xF3n de Importaci\xF3n"),t(),e(49,"p",35),r(50,"Define los par\xE1metros para el proceso"),t()()(),e(51,"div",36)(52,"div",37)(53,"label",38),r(54," Per\xEDodo Acad\xE9mico "),e(55,"span",39),r(56,"*"),t()(),e(57,"select",40),v("ngModelChange",function(m){return n.selectedPeriodoId.set(m?+m:null)}),e(58,"option",41),r(59,"\u2014 Selecciona un per\xEDodo \u2014"),t(),b(60,pe,2,4,"option",42),t(),e(61,"p",43),l(62,"i",44),r(63," Debe ser el per\xEDodo actual activo en el sistema "),t()()()(),e(64,"section",30)(65,"div",31)(66,"div",45),l(67,"i",46),t(),e(68,"div")(69,"h2",34),r(70,"Archivo de Datos"),t(),e(71,"p",35),r(72,"Selecciona o arrastra tu archivo Excel/CSV"),t()()(),e(73,"div",47),v("dragover",function(m){return n.onDragOver(m)})("dragleave",function(m){return n.onDragLeave(m)})("drop",function(m){return n.onDrop(m)}),e(74,"div",48)(75,"div",49),l(76,"i",50),t(),e(77,"div",51)(78,"div",52),r(79),t(),e(80,"div",53),r(81),t()(),e(82,"label",54),l(83,"i",21),r(84),e(85,"input",55),v("change",function(m){return n.onFileChange(m)}),t()(),b(86,xe,11,2,"div",56),e(87,"div",57),r(88," Formatos soportados: .xlsx, .xls, .csv (m\xE1x. 20MB) "),t()()()(),e(89,"div",58)(90,"button",59),v("click",function(){return n.importar()}),l(91,"i",60),b(92,ge,1,0,"i",61),r(93),t(),e(94,"button",62),v("click",function(){return n.limpiar()}),l(95,"i",63),r(96," Limpiar Todo "),t(),e(97,"button",64),v("click",function(){return n.exportarCSV()}),l(98,"i",65),r(99," Exportar Resultados "),t()()(),e(100,"div",66)(101,"section",30)(102,"div",67)(103,"div",68),l(104,"i",69),t(),e(105,"h3",34),r(106,"Gu\xEDa R\xE1pida"),t()(),e(107,"div",70)(108,"div",71),l(109,"i",72),e(110,"div",73)(111,"div",74),r(112,"Encabezados requeridos"),t(),e(113,"div",75),r(114," c\xF3digo estudiante, documento, correo, ciclo, grupo, modalidad estudio, modo contrato, fecha matr\xEDcula "),t()()(),e(115,"div",76),l(116,"i",77),e(117,"div",73)(118,"div",78),r(119,"Per\xEDodo correcto"),t(),e(120,"div",79),r(121," Aseg\xFArate de seleccionar el per\xEDodo acad\xE9mico actual y activo "),t()()(),e(122,"div",80),l(123,"i",81),e(124,"div",73)(125,"div",82),r(126,"EP-SEDE"),t(),e(127,"div",83),r(128," Si gestionas m\xFAltiples sedes, el backend te mostrar\xE1 opciones para elegir. "),t()()()()(),b(129,be,39,7,"section",84),t()(),b(130,_e,35,4,"section",85)(131,Ee,19,6,"div",86),t()()),i&2&&(o(26),c("routerLinkActiveOptions",B(29,de)),o(13),c("ngIf",n.error()),o(18),c("ngModel",n.selectedPeriodoId()??""),o(),c("ngValue",null),o(2),c("ngForOf",n.periodos()),o(13),T("border-slate-300",!n.over())("border-emerald-400",n.over())("bg-emerald-50",n.over())("ring-2",n.over())("ring-emerald-200",n.over()),o(6),x(" ",n.archivo()?"Archivo seleccionado":"Arrastra tu archivo aqu\xED"," "),o(2),x(" ",n.archivo()?"Todo listo para importar":"o selecciona desde tu dispositivo"," "),o(3),x(" ",n.archivo()?"Cambiar archivo":"Buscar archivo"," "),o(2),c("ngIf",n.archivo()),o(4),c("disabled",n.loading()||!n.archivo()||!n.selectedPeriodoId()),o(),T("hidden",n.loading()),o(),c("ngIf",n.loading()),o(),x(" ",n.loading()?"Procesando...":"Iniciar Importaci\xF3n"," "),o(),c("disabled",n.loading()),o(3),c("disabled",!n.rows().length),o(32),c("ngIf",n.summary()),o(),c("ngIf",n.rows().length),o(),c("ngIf",n.loading()))},dependencies:[G,z,H,K,ae,ie,re,te,Z,ee,X,Q,W,q],encapsulation:2});var oe=I;export{oe as MatriculasImportPage};
