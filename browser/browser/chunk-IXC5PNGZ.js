import{a as b}from"./chunk-LWNR2F3M.js";import{C as y}from"./chunk-FE5WSVYG.js";import{A as d,K as g,O as l,Sa as h,T as u,Tb as f,fa as o,w as p}from"./chunk-63T4HJ2B.js";var n=class n{constructor(){this._messages=o([]);this.messages=this._messages.asReadonly()}push(e,t){this._messages.update(i=>[...i,{id:Date.now(),type:e,text:t}]),setTimeout(()=>this.removeLast(),4e3)}info(e){this.push("info",e)}success(e){this.push("success",e)}warn(e){this.push("warn",e)}error(e){this.push("error",e)}remove(e){this._messages.update(t=>t.filter(i=>i.id!==e))}removeLast(){let e=this._messages();e.length&&this.remove(e[0].id)}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=l({token:n,factory:n.\u0275fac,providedIn:"root"});var v=n;var a=class a{constructor(){this.http=u(y);this.base=u(b);this._session=o({token:localStorage.getItem("token"),user:null,academico:null});this.session=this._session.asReadonly();this.isLoggedIn=f(()=>!!this._session().token)}lookup(e){return this.http.post(`${this.base}/auth/lookup`,e)}login(e){return this.http.post(`${this.base}/auth/login`,e).pipe(g(t=>{localStorage.setItem("token",t.token),this._session.set({token:t.token,user:t.user,academico:t.academico})}))}logout(){return this.http.post(`${this.base}/auth/logout`,{}).pipe(p(()=>this.http.post(`${this.base}/auth/logout`,{})),d(()=>this.clearSession()))}clearSession(){localStorage.removeItem("token"),this._session.set({token:null,user:null,academico:null})}};a.\u0275fac=function(t){return new(t||a)},a.\u0275prov=l({token:a,factory:a.\u0275fac,providedIn:"root"});var _=a;var r=class r{constructor(){this.hideTimer=null;this.zone=u(h);this._visible=o(!1);this._text=o("S\xE9 \xEDntegro, s\xE9 misionero y s\xE9 innovador");this._type=o("welcome");this._icon=o("fa-solid fa-bolt");this._action=o(null);this._duration=o(5e3);this.visible=this._visible.asReadonly();this.text=this._text.asReadonly();this.type=this._type.asReadonly();this.icon=this._icon.asReadonly();this.action=this._action.asReadonly();this.duration=this._duration.asReadonly()}show(e=5e3,t,i){let s=typeof e=="number"?{duration:e,text:t,type:i}:e,c=s.type??"welcome";this._text.set(s.text??this._text()),this._type.set(c),this._icon.set(s.icon??this.iconFor(c)),this._action.set(s.action??null),this._duration.set(s.duration??5e3),this._visible.set(!0),this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null);let m=this._duration();m>0&&this.zone.runOutsideAngular(()=>{this.hideTimer=setTimeout(()=>{this.zone.run(()=>this.hide())},m)})}hide(){this._visible.set(!1),this.hideTimer&&(clearTimeout(this.hideTimer),this.hideTimer=null)}showWelcome(e=5e3){this.show({duration:e,type:"welcome"})}showOnce(e,t={},i=1){try{let s=Date.now(),c=Number(localStorage.getItem(e)||0);if(c&&s<c)return;this.show(t),localStorage.setItem(e,String(s+i*864e5))}catch{}}iconFor(e){let t={welcome:"fa-solid fa-bolt",success:"fa-solid fa-check",error:"fa-solid fa-triangle-exclamation",warning:"fa-solid fa-circle-exclamation",info:"fa-solid fa-circle-info"};return t[e]??t.welcome}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});var k=r;export{v as a,_ as b,k as c};
